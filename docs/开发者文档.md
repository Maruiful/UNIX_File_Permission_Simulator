# UNIX æ–‡ä»¶æƒé™æ¨¡æ‹Ÿå™¨ - å¼€å‘è€…æ–‡æ¡£

## ğŸ“š ç›®å½•

1. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
2. [æ•°æ®ç»“æ„è¯´æ˜](#æ•°æ®ç»“æ„è¯´æ˜)
3. [API å‚è€ƒ](#api-å‚è€ƒ)
4. [æ‰©å±•æŒ‡å—](#æ‰©å±•æŒ‡å—)
5. [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)
6. [ç¼–è¯‘å’Œæ„å»º](#ç¼–è¯‘å’Œæ„å»º)

---

## æ¶æ„è®¾è®¡

### é¡¹ç›®ç»“æ„

```
UNIX_File_Permission_Simulator/
â”œâ”€â”€ KernProject/              # å†…æ ¸é¡¹ç›®(é™æ€åº“)
â”‚   â”œâ”€â”€ file_system.h         # æ–‡ä»¶ç³»ç»Ÿæ¥å£
â”‚   â”œâ”€â”€ file_system.c         # æ–‡ä»¶ç³»ç»Ÿå®ç°
â”‚   â”œâ”€â”€ user_manager.h        # ç”¨æˆ·ç®¡ç†æ¥å£
â”‚   â”œâ”€â”€ user_manager.c        # ç”¨æˆ·ç®¡ç†å®ç°
â”‚   â”œâ”€â”€ types.h               # å…¬å…±ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ framework.h           # é¢„ç¼–è¯‘å¤´è®¾ç½®
â”‚   â””â”€â”€ pch.h                 # é¢„ç¼–è¯‘å¤´å®šä¹‰
â”‚
â”œâ”€â”€ DemoProject/              # æ¼”ç¤ºé¡¹ç›®(å¯æ‰§è¡Œæ–‡ä»¶)
â”‚   â”œâ”€â”€ DemoProject.cpp       # ä¸»ç¨‹åºå’Œæµ‹è¯•ä»£ç 
â”‚   â””â”€â”€ InteractiveShell      # äº¤äº’å¼Shellå®ç°
â”‚
â”œâ”€â”€ docs/                     # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ ç”¨æˆ·æ‰‹å†Œ.md
â”‚   â””â”€â”€ å¼€å‘è€…æ–‡æ¡£.md
â”‚
â””â”€â”€ UNIX_File_Permission_Simulator.slnx  # Visual Studio è§£å†³æ–¹æ¡ˆ
```

### åŒå±‚æ¶æ„è®¾è®¡

æ ¹æ®è¯¾ç¨‹è¦æ±‚,é¡¹ç›®é‡‡ç”¨ä¸¥æ ¼çš„**åŒå±‚æ¶æ„**:

#### 1ï¸âƒ£ **å†…æ ¸å±‚ (KernProject)**

**èŒè´£**:
- å®ç°æ ¸å¿ƒæ•°æ®ç»“æ„å’Œç®—æ³•
- æä¾›æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ¥å£
- æä¾›ç”¨æˆ·ç®¡ç†æ¥å£
- **ä¸åŒ…å«ä»»ä½• I/O æ“ä½œ**
- **ä¸ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°**(é™¤åŸºæœ¬çš„ C è¿è¡Œæ—¶)

**æŠ€æœ¯é™åˆ¶**:
- âœ… ä½¿ç”¨ C è¯­è¨€(å…è®¸ C++ ä½†ä¸æ¨è)
- âŒ ç¦æ­¢ `cin`/`cout`, `printf`/`scanf`
- âŒ ç¦æ­¢çª—å£æ“ä½œ
- âŒ ç¦æ­¢ UI æ˜¾ç¤º
- âœ… ç´§å‡‘ã€èŠ‚çœç©ºé—´çš„æ•°æ®ç»“æ„
- âœ… å¯ç”¨é¢„ç¼–è¯‘å¤´ä¼˜åŒ–

**è¾“å‡º**: é™æ€åº“æ–‡ä»¶ `KernProject.lib`

#### 2ï¸âƒ£ **æ¼”ç¤ºå±‚ (DemoProject)**

**èŒè´£**:
- é“¾æ¥ KernProject.lib
- æä¾›æ§åˆ¶å° UI
- æŒ‰é¡ºåºè°ƒç”¨å†…æ ¸å‡½æ•°æ¼”ç¤ºåŠŸèƒ½
- ä½¿ç”¨æ ‡å‡† I/O è¿›è¡Œæµ‹è¯•å’Œäº¤äº’
- éªŒè¯å†…æ ¸å®ç°çš„æ­£ç¡®æ€§

**æŠ€æœ¯è‡ªç”±**:
- âœ… è‡ªç”±ä½¿ç”¨ C++ ç‰¹æ€§
- âœ… ä½¿ç”¨æ ‡å‡† I/O (`iostream`, `printf` ç­‰)
- âœ… åˆ›å»ºæµ‹è¯•åœºæ™¯å’Œ UI
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ

**è¾“å‡º**: å¯æ‰§è¡Œæ–‡ä»¶ `DemoProject.exe`

### æ¨¡å—åˆ’åˆ†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DemoProject.exe                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ æµ‹è¯•ä»£ç       â”‚  â”‚ äº¤äº’å¼Shell  â”‚  â”‚   UIå±‚      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†• é“¾æ¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  KernProject.lib                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  æ–‡ä»¶ç³»ç»Ÿ     â”‚              â”‚  ç”¨æˆ·ç®¡ç†     â”‚    â”‚
â”‚  â”‚  File System  â”‚              â”‚ User Manager â”‚    â”‚
â”‚  â”‚              â”‚              â”‚              â”‚    â”‚
â”‚  â”‚ â€¢ ç›®å½•æ ‘ç»“æ„  â”‚              â”‚ â€¢ ç”¨æˆ·æ•°æ®   â”‚    â”‚
â”‚  â”‚ â€¢ æƒé™æ£€æŸ¥    â”‚              â”‚ â€¢ ç»„ç®¡ç†     â”‚    â”‚
â”‚  â”‚ â€¢ è·¯å¾„è§£æ    â”‚              â”‚ â€¢ æˆå‘˜å…³ç³»   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†• ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   C Runtime Library                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ•°æ®ç»“æ„è¯´æ˜

### æ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„

#### FileNode (æ–‡ä»¶èŠ‚ç‚¹)

**å®šä¹‰ä½ç½®**: [`types.h`](KernProject/types.h)

```c
typedef struct FileNode {
    int inode;                  // inode å·(å”¯ä¸€æ ‡è¯†)
    char filename[MAX_FILENAME_LEN];  // æ–‡ä»¶å
    FileType type;              // æ–‡ä»¶ç±»å‹(ç›®å½•/æ™®é€šæ–‡ä»¶)
    Permissions perms;          // æƒé™è®¾ç½®
    int uid;                    // æ‰€æœ‰è€…ç”¨æˆ·ID
    int gid;                    // æ‰€æœ‰è€…ç»„ID
    struct FileNode* parent;    // çˆ¶ç›®å½•æŒ‡é’ˆ
    struct FileNode* children;  // å­æ–‡ä»¶/ç›®å½•é“¾è¡¨å¤´
    struct FileNode* next;      // åŒçº§é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
} FileNode;
```

**è®¾è®¡è¦ç‚¹**:
- ä½¿ç”¨**é“¾è¡¨æ ‘ç»“æ„**è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡
- æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤çˆ¶æŒ‡é’ˆå’Œå­èŠ‚ç‚¹é“¾è¡¨
- åŒçº§èŠ‚ç‚¹é€šè¿‡ `next` æŒ‡é’ˆè¿æ¥
- æ ¹ç›®å½•çš„ `parent` ä¸º `NULL`, `filename` ä¸º `""`

**å†…å­˜å¸ƒå±€ç¤ºä¾‹**:
```
        /
        â”œâ”€â”€ home/
        â”‚   â”œâ”€â”€ alice/ â†’ file1.txt â†’ file2.txt â†’ NULL
        â”‚   â””â”€â”€ bob/ â†’ NULL
        â””â”€â”€ tmp/ â†’ NULL
```

#### FileType (æ–‡ä»¶ç±»å‹)

```c
typedef enum {
    FILE_TYPE_DIRECTORY = 1,  // ç›®å½•
    FILE_TYPE_REGULAR = 2     // æ™®é€šæ–‡ä»¶
} FileType;
```

#### Permissions (æƒé™ç»“æ„)

```c
typedef struct {
    int owner_perms;   // æ‰€æœ‰è€…æƒé™ (rwx)
    int group_perms;   // ç”¨æˆ·ç»„æƒé™ (rwx)
    int other_perms;   // å…¶ä»–ç”¨æˆ·æƒé™ (rwx)
} Permissions;
```

**æƒé™ä½å®šä¹‰**:
```c
#define PERM_READ    4  // 100b - è¯»æƒé™
#define PERM_WRITE   2  // 010b - å†™æƒé™
#define PERM_EXECUTE 1  // 001b - æ‰§è¡Œæƒé™
```

**æƒé™ç»„åˆç¤ºä¾‹**:
```c
// rwxr-xr-x (755)
perms.owner_perms = PERM_READ | PERM_WRITE | PERM_EXECUTE;  // 7
perms.group_perms = PERM_READ | PERM_EXECUTE;                // 5
perms.other_perms = PERM_READ | PERM_EXECUTE;                // 5
```

### ç”¨æˆ·ç®¡ç†æ•°æ®ç»“æ„

#### User (ç”¨æˆ·)

```c
typedef struct {
    int uid;                    // ç”¨æˆ·ID
    int gid;                    // ä¸»ç»„ID
    char username[MAX_NAME_LEN]; // ç”¨æˆ·å
} User;
```

#### Group (ç”¨æˆ·ç»„)

```c
typedef struct {
    int gid;                      // ç»„ID
    char groupname[MAX_NAME_LEN]; // ç»„å
    int members[MAX_USERS];       // æˆå‘˜UIDæ•°ç»„
    int member_count;             // æˆå‘˜æ•°é‡
} Group;
```

**è®¾è®¡è¦ç‚¹**:
- ç”¨æˆ·å’Œç»„åˆ†åˆ«ä½¿ç”¨**å›ºå®šå¤§å°æ•°ç»„**å­˜å‚¨
- `MAX_USERS` å’Œ `MAX_GROUPS` å®šä¹‰æœ€å¤§å®¹é‡
- ç»„æˆå‘˜ä½¿ç”¨ UID æ•°ç»„,ä¸ä½¿ç”¨æŒ‡é’ˆ(ç®€åŒ–å†…å­˜ç®¡ç†)

### å¸¸é‡å®šä¹‰

```c
#define MAX_FILES          1024    // æœ€å¤§æ–‡ä»¶èŠ‚ç‚¹æ•°
#define MAX_USERS          256     // æœ€å¤§ç”¨æˆ·æ•°
#define MAX_GROUPS         256     // æœ€å¤§ç”¨æˆ·ç»„æ•°
#define MAX_FILENAME_LEN   64      // æœ€å¤§æ–‡ä»¶åé•¿åº¦
#define MAX_NAME_LEN       32      // æœ€å¤§ç”¨æˆ·å/ç»„åé•¿åº¦
#define MAX_PATH_LEN       256     // æœ€å¤§è·¯å¾„é•¿åº¦
```

---

## API å‚è€ƒ

### æ–‡ä»¶ç³»ç»Ÿ API (file_system.h)

#### åˆå§‹åŒ–å’Œæ¸…ç†

##### `FileSystemStatus fs_init(void)`

**åŠŸèƒ½**: åˆå§‹åŒ–æ–‡ä»¶ç³»ç»Ÿ,åˆ›å»ºæ ¹ç›®å½•

**è¿”å›å€¼**:
- `FS_SUCCESS` - åˆå§‹åŒ–æˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ

**ç¤ºä¾‹**:
```c
if (fs_init() == FS_SUCCESS) {
    // æ–‡ä»¶ç³»ç»Ÿå·²å°±ç»ª
}
```

##### `FileNode* fs_get_root(void)`

**åŠŸèƒ½**: è·å–æ ¹ç›®å½•èŠ‚ç‚¹æŒ‡é’ˆ

**è¿”å›å€¼**: æ ¹ç›®å½•çš„ `FileNode*` æŒ‡é’ˆ

---

#### æ–‡ä»¶å’Œç›®å½•æ“ä½œ

##### `FileSystemStatus fs_create(const char* path, const char* filename, int owner_uid, int owner_gid, Permissions perms, FileType type)`

**åŠŸèƒ½**: åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•

**å‚æ•°**:
- `path` - çˆ¶ç›®å½•è·¯å¾„(å¦‚ `/home`, `/`)
- `filename` - æ–‡ä»¶å(å¦‚ `test.txt`, `user`)
- `owner_uid` - æ‰€æœ‰è€…ç”¨æˆ·ID
- `owner_gid` - æ‰€æœ‰è€…ç»„ID
- `perms` - æƒé™è®¾ç½®
- `type` - æ–‡ä»¶ç±»å‹(`FILE_TYPE_DIRECTORY` æˆ– `FILE_TYPE_REGULAR`)

**è¿”å›å€¼**:
- `FS_SUCCESS` - åˆ›å»ºæˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `FS_ERR_EXISTS` - æ–‡ä»¶å·²å­˜åœ¨
- `FS_ERR_NOT_FOUND` - çˆ¶ç›®å½•ä¸å­˜åœ¨
- `FS_ERR_PERMISSION` - æƒé™ä¸è¶³
- `FS_ERR_LIMIT` - è¾¾åˆ°æ–‡ä»¶æ•°é‡é™åˆ¶

**ç¤ºä¾‹**:
```c
Permissions perms;
perms.owner_perms = PERM_READ | PERM_WRITE;
perms.group_perms = PERM_READ;
perms.other_perms = PERM_READ;

// åˆ›å»ºæ–‡ä»¶ /home/test.txt
fs_create("/home", "test.txt", 0, 0, perms, FILE_TYPE_REGULAR);

// åˆ›å»ºç›®å½• /home/user
fs_create("/home", "user", 0, 0, perms, FILE_TYPE_DIRECTORY);
```

##### `FileSystemStatus fs_delete(const char* path)`

**åŠŸèƒ½**: åˆ é™¤æ–‡ä»¶æˆ–ç©ºç›®å½•

**å‚æ•°**:
- `path` - å®Œæ•´è·¯å¾„(å¦‚ `/home/test.txt`)

**è¿”å›å€¼**:
- `FS_SUCCESS` - åˆ é™¤æˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `FS_ERR_NOT_FOUND` - æ–‡ä»¶ä¸å­˜åœ¨
- `FS_ERR_PERMISSION` - æƒé™ä¸è¶³
- `FS_ERR_NOT_EMPTY` - ç›®å½•éç©º

**æ³¨æ„**: ä¸èƒ½åˆ é™¤æ ¹ç›®å½•

##### `FileSystemStatus fs_delete_recursive(const char* path)`

**åŠŸèƒ½**: é€’å½’åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•(åŒ…å«æ‰€æœ‰å†…å®¹)

**å‚æ•°**:
- `path` - å®Œæ•´è·¯å¾„

**è¿”å›å€¼**:
- `FS_SUCCESS` - åˆ é™¤æˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `FS_ERR_NOT_FOUND` - æ–‡ä»¶ä¸å­˜åœ¨
- `FS_ERR_PERMISSION` - æƒé™ä¸è¶³

**æ³¨æ„**:
- ä¸èƒ½åˆ é™¤æ ¹ç›®å½•
- ä¼šæ£€æŸ¥æ¯ä¸ªå­æ–‡ä»¶/ç›®å½•çš„æƒé™

---

#### æ–‡ä»¶æŸ¥æ‰¾

##### `FileNode* fs_find(const char* path)`

**åŠŸèƒ½**: æ ¹æ®ç»å¯¹è·¯å¾„æŸ¥æ‰¾æ–‡ä»¶èŠ‚ç‚¹

**å‚æ•°**:
- `path` - ç»å¯¹è·¯å¾„(å¿…é¡»ä»¥ `/` å¼€å¤´)

**è¿”å›å€¼**:
- æˆåŠŸ: æ–‡ä»¶èŠ‚ç‚¹æŒ‡é’ˆ
- å¤±è´¥: `NULL`

**ç¤ºä¾‹**:
```c
FileNode* node = fs_find("/home/user/file.txt");
if (node != NULL) {
    printf("æ‰¾åˆ°æ–‡ä»¶: %s\n", node->filename);
}
```

##### `FileNode* fs_find_relative(FileNode* current_dir, const char* path)`

**åŠŸèƒ½**: ä»æŒ‡å®šç›®å½•å¼€å§‹æŸ¥æ‰¾ç›¸å¯¹è·¯å¾„

**å‚æ•°**:
- `current_dir` - å½“å‰ç›®å½•èŠ‚ç‚¹
- `path` - ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„

**è¿”å›å€¼**:
- æˆåŠŸ: æ–‡ä»¶èŠ‚ç‚¹æŒ‡é’ˆ
- å¤±è´¥: `NULL`

**æ”¯æŒçš„è·¯å¾„**:
- ç»å¯¹è·¯å¾„: `/home/user`
- ç›¸å¯¹è·¯å¾„: `user`, `../user`, `./file.txt`
- æ··åˆè·¯å¾„: `../admin/../user/file.txt`

---

#### æ–‡ä»¶ç§»åŠ¨å’Œå¤åˆ¶

##### `FileSystemStatus fs_move(const char* src_path, const char* dest_path, int uid, int gid)`

**åŠŸèƒ½**: ç§»åŠ¨æ–‡ä»¶åˆ°ä¸åŒç›®å½•

**å‚æ•°**:
- `src_path` - æºæ–‡ä»¶å®Œæ•´è·¯å¾„
- `dest_path` - ç›®æ ‡ç›®å½•è·¯å¾„(ä¸æ˜¯å®Œæ•´æ–‡ä»¶è·¯å¾„)
- `uid` - æ‰§è¡Œæ“ä½œçš„ç”¨æˆ·ID
- `gid` - æ‰§è¡Œæ“ä½œçš„ç»„ID

**è¿”å›å€¼**:
- `FS_SUCCESS` - ç§»åŠ¨æˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `FS_ERR_NOT_FOUND` - æºæˆ–ç›®æ ‡ä¸å­˜åœ¨
- `FS_ERR_PERMISSION` - æƒé™ä¸è¶³
- `FS_ERR_EXISTS` - ç›®æ ‡ç›®å½•ä¸­å·²æœ‰åŒåæ–‡ä»¶
- `FS_ERR_NOT_DIR` - ç›®æ ‡ä¸æ˜¯ç›®å½•

**æƒé™è¦æ±‚**:
- æºæ–‡ä»¶çš„å†™æƒé™
- æºçˆ¶ç›®å½•çš„å†™æƒé™
- ç›®æ ‡çˆ¶ç›®å½•çš„å†™æƒé™

**ç¤ºä¾‹**:
```c
// å°† /home/file.txt ç§»åŠ¨åˆ° /home/user/ ç›®å½•
fs_move("/home/file.txt", "/home/user", 0, 0);
```

##### `FileSystemStatus fs_copy(const char* src_path, const char* dest_path, int uid, int gid)`

**åŠŸèƒ½**: å¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•

**å‚æ•°**: åŒ `fs_move`

**è¿”å›å€¼**: åŒ `fs_move`

**ç‰¹ç‚¹**:
- åªå¤åˆ¶æ–‡ä»¶,ä¸å¤åˆ¶ç›®å½•
- å¤åˆ¶çš„æ–‡ä»¶æ‰€æœ‰è€…æ˜¯æ‰§è¡Œå¤åˆ¶çš„ç”¨æˆ·
- ç»§æ‰¿æºæ–‡ä»¶çš„æƒé™è®¾ç½®

---

#### æ–‡ä»¶é‡å‘½å

##### `FileSystemStatus fs_rename(const char* path, const char* new_name, int uid, int gid)`

**åŠŸèƒ½**: é‡å‘½åæ–‡ä»¶(åœ¨åŒä¸€ç›®å½•å†…)

**å‚æ•°**:
- `path` - æ–‡ä»¶å®Œæ•´è·¯å¾„
- `new_name` - æ–°æ–‡ä»¶å
- `uid` - æ‰§è¡Œæ“ä½œçš„ç”¨æˆ·ID
- `gid` - æ‰§è¡Œæ“ä½œçš„ç»„ID

**è¿”å›å€¼**:
- `FS_SUCCESS` - é‡å‘½åæˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `FS_ERR_NOT_FOUND` - æ–‡ä»¶ä¸å­˜åœ¨
- `FS_ERR_PERMISSION` - æƒé™ä¸è¶³
- `FS_ERR_EXISTS` - æ–°æ–‡ä»¶åå·²å­˜åœ¨

**æ³¨æ„**: ä¸èƒ½é‡å‘½åæ ¹ç›®å½•

---

#### æƒé™ç®¡ç†

##### `FileSystemStatus fs_chmod(const char* path, Permissions perms)`

**åŠŸèƒ½**: ä¿®æ”¹æ–‡ä»¶æƒé™

**å‚æ•°**:
- `path` - æ–‡ä»¶è·¯å¾„
- `perms` - æ–°æƒé™è®¾ç½®

**è¿”å›å€¼**:
- `FS_SUCCESS` - ä¿®æ”¹æˆåŠŸ
- `FS_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `FS_ERR_NOT_FOUND` - æ–‡ä»¶ä¸å­˜åœ¨

**æ³¨æ„**:
- Root å¯ä»¥ä¿®æ”¹ä»»ä½•æ–‡ä»¶æƒé™
- æ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥ä¿®æ”¹æƒé™
- å…¶ä»–ç”¨æˆ·ä¸èƒ½ä¿®æ”¹

##### `PermissionResult fs_check_permission(FileNode* file, int uid, int gid, OperationType op)`

**åŠŸèƒ½**: æ£€æŸ¥ç”¨æˆ·å¯¹æ–‡ä»¶çš„æ“ä½œæƒé™

**å‚æ•°**:
- `file` - æ–‡ä»¶èŠ‚ç‚¹æŒ‡é’ˆ
- `uid` - ç”¨æˆ·ID
- `gid` - ç”¨æˆ·ç»„ID
- `op` - æ“ä½œç±»å‹

**è¿”å›å€¼**:
- `PERM_GRANTED` - æƒé™å…è®¸
- `PERM_DENIED` - æƒé™æ‹’ç»

**æ“ä½œç±»å‹**:
```c
typedef enum {
    OP_READ = 1,     // è¯»æ“ä½œ
    OP_WRITE = 2,    // å†™æ“ä½œ
    OP_EXECUTE = 3   // æ‰§è¡Œæ“ä½œ
} OperationType;
```

**æƒé™æ£€æŸ¥é€»è¾‘**:
1. å¦‚æœ `uid == 0` (root),å…è®¸
2. å¦‚æœ `uid == file->uid`,æ£€æŸ¥æ‰€æœ‰è€…æƒé™
3. å¦‚æœæ˜¯ç»„æˆå‘˜(`um_is_group_member(file->gid, uid)`),æ£€æŸ¥ç»„æƒé™
4. å¦åˆ™æ£€æŸ¥å…¶ä»–ç”¨æˆ·æƒé™

---

#### è·¯å¾„è§£æ

##### `int fs_parse_path(const char* path, char* dirname, char* filename)`

**åŠŸèƒ½**: è§£æè·¯å¾„,åˆ†ç¦»ç›®å½•å’Œæ–‡ä»¶å

**å‚æ•°**:
- `path` - å®Œæ•´è·¯å¾„(å¦‚ `/home/user/file.txt`)
- `dirname` - è¾“å‡º:ç›®å½•éƒ¨åˆ†(å¦‚ `/home/user`)
- `filename` - è¾“å‡º:æ–‡ä»¶åéƒ¨åˆ†(å¦‚ `file.txt`)

**è¿”å›å€¼**:
- `0` - è§£ææˆåŠŸ
- `-1` - è§£æå¤±è´¥

**ç¤ºä¾‹**:
```c
char dir[256], name[64];
fs_parse_path("/home/user/file.txt", dir, name);
// dir = "/home/user", name = "file.txt"
```

##### `int fs_normalize_path(const char* input, char* output)`

**åŠŸèƒ½**: è§„èŒƒåŒ–è·¯å¾„å­—ç¬¦ä¸²

**å‚æ•°**:
- `input` - è¾“å…¥è·¯å¾„(å¯èƒ½åŒ…å« `.` æˆ– `..`)
- `output` - è¾“å‡ºç¼“å†²åŒº(è‡³å°‘ `MAX_PATH_LEN`)

**è¿”å›å€¼**:
- `0` - è§„èŒƒåŒ–æˆåŠŸ
- `-1` - è§„èŒƒåŒ–å¤±è´¥

**å¤„ç†**:
- `.` (å½“å‰ç›®å½•)
- `..` (çˆ¶ç›®å½•)
- åˆå¹¶è¿ç»­çš„ `/`
- ç§»é™¤æœ«å°¾çš„ `/`(æ ¹ç›®å½•é™¤å¤–)

**ç¤ºä¾‹**:
```c
char output[256];
fs_normalize_path("/home/../user/./file.txt", output);
// output = "/user/file.txt"
```

---

### ç”¨æˆ·ç®¡ç† API (user_manager.h)

#### åˆå§‹åŒ–

##### `void um_init(void)`

**åŠŸèƒ½**: åˆå§‹åŒ–ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ

**æ³¨æ„**: ä½¿ç”¨å…¶ä»–ç”¨æˆ·ç®¡ç†å‡½æ•°å‰å¿…é¡»è°ƒç”¨

---

#### ç”¨æˆ·æ“ä½œ

##### `UserStatus um_create_user(const char* username, int uid, int gid)`

**åŠŸèƒ½**: åˆ›å»ºæ–°ç”¨æˆ·

**å‚æ•°**:
- `username` - ç”¨æˆ·å
- `uid` - ç”¨æˆ·ID
- `gid` - ä¸»ç»„ID

**è¿”å›å€¼**:
- `USER_SUCCESS` - åˆ›å»ºæˆåŠŸ
- `USER_ERR_EXISTS` - ç”¨æˆ·å·²å­˜åœ¨
- `USER_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `USER_ERR_LIMIT` - è¾¾åˆ°ç”¨æˆ·æ•°é‡é™åˆ¶

##### `User* um_find_user_by_uid(int uid)`

**åŠŸèƒ½**: æ ¹æ®UIDæŸ¥æ‰¾ç”¨æˆ·

**è¿”å›å€¼**: ç”¨æˆ·æŒ‡é’ˆ,æœªæ‰¾åˆ°è¿”å› `NULL`

##### `User* um_find_user_by_name(const char* username)`

**åŠŸèƒ½**: æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·

**è¿”å›å€¼**: ç”¨æˆ·æŒ‡é’ˆ,æœªæ‰¾åˆ°è¿”å› `NULL`

##### `UserStatus um_delete_user(int uid)`

**åŠŸèƒ½**: åˆ é™¤ç”¨æˆ·

**è¿”å›å€¼**:
- `USER_SUCCESS` - åˆ é™¤æˆåŠŸ
- `USER_ERR_NOT_FOUND` - ç”¨æˆ·ä¸å­˜åœ¨
- `USER_ERR_INVALID` - å‚æ•°æ— æ•ˆ

**æ³¨æ„**: åˆ é™¤ç”¨æˆ·ä¸ä¼šè‡ªåŠ¨ä»ç»„ä¸­ç§»é™¤

##### `int um_get_user_count(void)`

**åŠŸèƒ½**: è·å–å½“å‰ç”¨æˆ·æ€»æ•°

**è¿”å›å€¼**: ç”¨æˆ·æ•°é‡

---

#### ç”¨æˆ·ç»„æ“ä½œ

##### `GroupStatus um_create_group(const char* groupname, int gid)`

**åŠŸèƒ½**: åˆ›å»ºæ–°ç”¨æˆ·ç»„

**è¿”å›å€¼**:
- `GROUP_SUCCESS` - åˆ›å»ºæˆåŠŸ
- `GROUP_ERR_EXISTS` - ç»„å·²å­˜åœ¨
- `GROUP_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `GROUP_ERR_LIMIT` - è¾¾åˆ°ç»„æ•°é‡é™åˆ¶

##### `Group* um_find_group_by_gid(int gid)`

**åŠŸèƒ½**: æ ¹æ®GIDæŸ¥æ‰¾ç”¨æˆ·ç»„

**è¿”å›å€¼**: ç»„æŒ‡é’ˆ,æœªæ‰¾åˆ°è¿”å› `NULL`

##### `GroupStatus um_add_group_member(int gid, int uid)`

**åŠŸèƒ½**: å‘ç»„æ·»åŠ æˆå‘˜

**è¿”å›å€¼**:
- `GROUP_SUCCESS` - æ·»åŠ æˆåŠŸ
- `GROUP_ERR_NOT_FOUND` - ç»„ä¸å­˜åœ¨
- `GROUP_ERR_INVALID` - å‚æ•°æ— æ•ˆ
- `GROUP_ERR_LIMIT` - ç»„æˆå‘˜å·²æ»¡

##### `GroupStatus um_remove_group_member(int gid, int uid)`

**åŠŸèƒ½**: ä»ç»„ç§»é™¤æˆå‘˜

**è¿”å›å€¼**:
- `GROUP_SUCCESS` - ç§»é™¤æˆåŠŸ
- `GROUP_ERR_NOT_FOUND` - ç»„æˆ–æˆå‘˜ä¸å­˜åœ¨
- `GROUP_ERR_INVALID` - å‚æ•°æ— æ•ˆ

##### `int um_is_group_member(int gid, int uid)`

**åŠŸèƒ½**: æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç»„æˆå‘˜

**è¿”å›å€¼**:
- `1` - æ˜¯æˆå‘˜
- `0` - ä¸æ˜¯æˆå‘˜

##### `GroupStatus um_delete_group(int gid)`

**åŠŸèƒ½**: åˆ é™¤ç”¨æˆ·ç»„

**è¿”å›å€¼**:
- `GROUP_SUCCESS` - åˆ é™¤æˆåŠŸ
- `GROUP_ERR_NOT_FOUND` - ç»„ä¸å­˜åœ¨

---

## æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

#### æ­¥éª¤1: åœ¨ `file_system.h` ä¸­å£°æ˜å‡½æ•°

```c
/**
 * æ–°åŠŸèƒ½æè¿°
 * @param param1 å‚æ•°1è¯´æ˜
 * @return è¿”å›å€¼è¯´æ˜
 */
FileSystemStatus fs_new_function(const char* param1);
```

#### æ­¥éª¤2: åœ¨ `file_system.c` ä¸­å®ç°å‡½æ•°

```c
FileSystemStatus fs_new_function(const char* param1) {
    // 1. å‚æ•°éªŒè¯
    if (param1 == 0) return FS_ERR_INVALID;

    // 2. æƒé™æ£€æŸ¥
    // PermissionResult perm = fs_check_permission(...);

    // 3. æ‰§è¡Œæ“ä½œ
    // ...

    // 4. è¿”å›ç»“æœ
    return FS_SUCCESS;
}
```

#### æ­¥éª¤3: åœ¨ DemoProject ä¸­æ·»åŠ æµ‹è¯•

```cpp
void test_new_function() {
    std::cout << "æµ‹è¯•æ–°åŠŸèƒ½" << std::endl;

    FileSystemStatus status = fs_new_function("/test");

    if (status == FS_SUCCESS) {
        std::cout << "æˆåŠŸ" << std::endl;
    } else {
        std::cout << "å¤±è´¥" << std::endl;
    }
}
```

#### æ­¥éª¤4: åœ¨ main() ä¸­è°ƒç”¨æµ‹è¯•

```cpp
int main() {
    // ... å…¶ä»–æµ‹è¯•
    test_new_function();
    return 0;
}
```

---

### æ·»åŠ æ–°çš„ Shell å‘½ä»¤

#### æ­¥éª¤1: å®ç°å‘½ä»¤å‡½æ•°

åœ¨ DemoProject.cpp ä¸­æ·»åŠ :

```cpp
void cmd_newcommand(const char* arg1) {
    if (arg1 == 0 || str_length(arg1) == 0) {
        std::cout << "newcommand: ç¼ºå°‘å‚æ•°" << std::endl;
        return;
    }

    // æƒé™æ£€æŸ¥
    // æ‰§è¡Œæ“ä½œ
    // æ˜¾ç¤ºç»“æœ
}
```

#### æ­¥éª¤2: åœ¨ `execute_command` ä¸­æ³¨å†Œ

```cpp
int execute_command(const char* input) {
    // ... è§£æå‘½ä»¤

    if (str_compare(cmd, "newcommand") == 0) {
        cmd_newcommand(args[0]);
    }
    // ...
}
```

#### æ­¥éª¤3: åœ¨ `cmd_help` ä¸­æ·»åŠ è¯´æ˜

```cpp
void cmd_help() {
    // ...
    std::cout << "  newcommand <arg>    - å‘½ä»¤è¯´æ˜" << std::endl;
}
```

---

### æ‰©å±•æ•°æ®ç»“æ„

#### æ·»åŠ æ–‡ä»¶å±æ€§

å¦‚æœéœ€è¦æ·»åŠ æ–‡ä»¶å±æ€§(å¦‚åˆ›å»ºæ—¶é—´ã€æ–‡ä»¶å¤§å°):

1. ä¿®æ”¹ `FileNode` ç»“æ„:

```c
typedef struct FileNode {
    // ... ç°æœ‰å­—æ®µ
    time_t create_time;      // åˆ›å»ºæ—¶é—´
    long file_size;          // æ–‡ä»¶å¤§å°
} FileNode;
```

2. ä¿®æ”¹ `fs_create` åˆå§‹åŒ–æ–°å­—æ®µ

3. æ›´æ–°ç›¸å…³æ“ä½œ(`fs_copy`, `fs_move` ç­‰)

---

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. ä½¿ç”¨å“ˆå¸Œè¡¨åŠ é€Ÿæ–‡ä»¶æŸ¥æ‰¾

**å½“å‰**: é“¾è¡¨æŸ¥æ‰¾ O(n)

**ä¼˜åŒ–**: ä½¿ç”¨å“ˆå¸Œè¡¨ O(1)

```c
// å»ºè®®æ•°æ®ç»“æ„
#define HASH_TABLE_SIZE 256

typedef struct {
    FileNode* table[HASH_TABLE_SIZE];
} FileHashCache;

// å“ˆå¸Œå‡½æ•°
int hash_path(const char* path) {
    int hash = 0;
    while (*path) {
        hash = (hash * 31 + *path) % HASH_TABLE_SIZE;
        path++;
    }
    return hash;
}
```

#### 2. ç¼“å­˜æœ€è¿‘è®¿é—®çš„æ–‡ä»¶

```c
#define CACHE_SIZE 16

typedef struct {
    char* path;
    FileNode* node;
} FileCache;

FileCache recent_files[CACHE_SIZE];
```

#### 3. å‡å°‘å­—ç¬¦ä¸²å¤åˆ¶

**å½“å‰**: å¤šæ¬¡è°ƒç”¨ `str_copy`

**ä¼˜åŒ–**: ä½¿ç”¨æŒ‡é’ˆå¼•ç”¨

---

## æµ‹è¯•æŒ‡å—

### å•å…ƒæµ‹è¯•ç»“æ„

DemoProject.cpp åŒ…å«çš„æµ‹è¯•:

```
ç¬¬ä¸€é˜¶æ®µ: ç”¨æˆ·å’Œç»„ç®¡ç†æµ‹è¯•
â”œâ”€â”€ test_basic_user_management()     # åŸºæœ¬ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ test_basic_group_management()    # åŸºæœ¬ç”¨æˆ·ç»„ç®¡ç†
â”œâ”€â”€ test_group_membership()           # ç»„æˆå‘˜ç®¡ç†
â””â”€â”€ test_deletion()                   # åˆ é™¤æ“ä½œ

ç¬¬äºŒé˜¶æ®µ: æ–‡ä»¶ç³»ç»Ÿæµ‹è¯•
â”œâ”€â”€ test_fs_init()                    # æ–‡ä»¶ç³»ç»Ÿåˆå§‹åŒ–
â”œâ”€â”€ test_fs_create()                  # åˆ›å»ºæ–‡ä»¶å’Œç›®å½•
â”œâ”€â”€ test_fs_find()                    # è·¯å¾„æŸ¥æ‰¾
â”œâ”€â”€ test_permission_check()           # æƒé™æ£€æŸ¥
â”œâ”€â”€ test_chmod()                      # ä¿®æ”¹æ–‡ä»¶æƒé™
â””â”€â”€ test_fs_delete()                  # åˆ é™¤æ“ä½œ

ç¬¬ä¸‰é˜¶æ®µ: æ–‡ä»¶ç§»åŠ¨å’Œé‡å‘½åæµ‹è¯•
â”œâ”€â”€ test_rename()                     # æ–‡ä»¶é‡å‘½å
â”œâ”€â”€ test_rename_directory()           # ç›®å½•é‡å‘½å
â”œâ”€â”€ test_move_file()                  # ç§»åŠ¨æ–‡ä»¶
â”œâ”€â”€ test_move_directory()             # ç§»åŠ¨ç›®å½•
â”œâ”€â”€ test_move_rename_permissions()    # æƒé™é™åˆ¶çš„ç§»åŠ¨
â”œâ”€â”€ test_copy()                       # æ–‡ä»¶å¤åˆ¶
â””â”€â”€ test_delete_recursive()           # é€’å½’åˆ é™¤

ç¬¬ä¸‰é˜¶æ®µç»­: è·¯å¾„è§£æåŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ test_normalize_path()             # è·¯å¾„è§„èŒƒåŒ–
â””â”€â”€ test_find_relative()              # ç›¸å¯¹è·¯å¾„æŸ¥æ‰¾

ä»»åŠ¡å…­: æ‰¹é‡æµ‹è¯•è„šæœ¬
â”œâ”€â”€ test_comprehensive_scenario()     # å¤šç”¨æˆ·åä½œé¡¹ç›®
â”œâ”€â”€ test_multi_user_collaboration()   # æƒé™ç»§æ‰¿æµ‹è¯•
â””â”€â”€ test_edge_cases()                 # è¾¹ç•Œæ¡ä»¶æµ‹è¯•
```

### è¿è¡Œæµ‹è¯•

#### æ–¹å¼1: è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
1. ç¼–è¯‘é¡¹ç›®: Ctrl+Shift+B
2. è¿è¡Œ: Ctrl+F5
3. é€‰æ‹©: 1 (è¿è¡Œæ‰€æœ‰æµ‹è¯•)
```

#### æ–¹å¼2: è¿è¡Œå•ä¸ªæµ‹è¯•

åœ¨ `main()` å‡½æ•°ä¸­æ³¨é‡Šæ‰å…¶ä»–æµ‹è¯•:

```cpp
int main() {
    // åˆå§‹åŒ–
    um_init();
    fs_init();

    // åªè¿è¡Œä¸€ä¸ªæµ‹è¯•
    test_permission_check();

    return 0;
}
```

#### æ–¹å¼3: ä½¿ç”¨äº¤äº’å¼Shell

```bash
1. è¿è¡Œ: Ctrl+F5
2. é€‰æ‹©: 2 (äº¤äº’å¼Shell)
3. æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤
```

### ç¼–å†™æµ‹è¯•ç”¨ä¾‹

#### æµ‹è¯•å‡½æ•°æ¨¡æ¿

```cpp
void test_your_feature() {
    std::cout << "\n=== æµ‹è¯•: ä½ çš„åŠŸèƒ½ ===" << std::endl;

    // 1. å‡†å¤‡æµ‹è¯•æ•°æ®
    FileSystemStatus status;
    FileNode* node;

    // 2. æ‰§è¡Œæµ‹è¯•æ­¥éª¤
    std::cout << "æ­¥éª¤1: æè¿°" << std::endl;
    status = fs_your_function(...);
    std::cout << "  ç»“æœ: " << (status == FS_SUCCESS ? "æˆåŠŸ" : "å¤±è´¥") << std::endl;

    // 3. éªŒè¯ç»“æœ
    node = fs_find("/path/to/file");
    std::cout << "  éªŒè¯: " << (node ? "æ‰¾åˆ°" : "æœªæ‰¾åˆ°") << std::endl;

    // 4. æ¸…ç†æµ‹è¯•æ•°æ®
    fs_delete("/path/to/file");

    std::cout << "âœ… æµ‹è¯•å®Œæˆ" << std::endl;
}
```

#### æµ‹è¯•è¦†ç›–è¦ç‚¹

- âœ… æ­£å¸¸æƒ…å†µ(æˆåŠŸè·¯å¾„)
- âœ… è¾¹ç•Œæƒ…å†µ(ç©ºå€¼ã€æœ€å¤§å€¼)
- âœ… é”™è¯¯æƒ…å†µ(æƒé™ä¸è¶³ã€æ–‡ä»¶ä¸å­˜åœ¨)
- âœ… å¹¶å‘æƒ…å†µ(å¤šä¸ªç”¨æˆ·)
- âœ… æ¸…ç†(æµ‹è¯•åæ¢å¤ç¯å¢ƒ)

### è°ƒè¯•æŠ€å·§

#### 1. ä½¿ç”¨çŠ¶æ€æ‰“å°

```cpp
void print_fs_status(FileSystemStatus status) {
    switch (status) {
        case FS_SUCCESS:
            std::cout << "æˆåŠŸ";
            break;
        case FS_ERR_INVALID:
            std::cout << "å¤±è´¥: å‚æ•°æ— æ•ˆ";
            break;
        // ... å…¶ä»–æƒ…å†µ
    }
    std::cout << std::endl;
}
```

#### 2. æ‰“å°æ–‡ä»¶æ ‘

```cpp
void print_file_tree(FileNode* node, int depth) {
    if (node == NULL) return;

    // ç¼©è¿›
    for (int i = 0; i < depth; i++) std::cout << "  ";

    // æ‰“å°èŠ‚ç‚¹ä¿¡æ¯
    std::cout << (node->type == FILE_TYPE_DIRECTORY ? "+" : "-");
    std::cout << " " << node->filename;
    std::cout << " (inode=" << node->inode << ")" << std::endl;

    // é€’å½’æ‰“å°å­èŠ‚ç‚¹
    print_file_tree(node->children, depth + 1);
    print_file_tree(node->next, depth);
}
```

#### 3. éªŒè¯æƒé™

```cpp
void verify_permission(const char* path, int uid, int gid, OperationType op) {
    FileNode* node = fs_find(path);
    if (node == NULL) {
        std::cout << "æ–‡ä»¶ä¸å­˜åœ¨" << std::endl;
        return;
    }

    PermissionResult result = fs_check_permission(node, uid, gid, op);
    const char* op_str = (op == OP_READ ? "è¯»" : op == OP_WRITE ? "å†™" : "æ‰§è¡Œ");

    std::cout << "UID=" << uid << " " << op_str << " æƒé™: ";
    std::cout << (result == PERM_GRANTED ? "å…è®¸" : "æ‹’ç»") << std::endl;
}
```

---

## ç¼–è¯‘å’Œæ„å»º

### å¼€å‘ç¯å¢ƒ

- **IDE**: Microsoft Visual Studio 2019 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Platform Toolset**: v145
- **C++ æ ‡å‡†**: C++20 (`stdcpp20`)

### é…ç½®ç±»å‹

- Debug/Release
- Win32/x64

### ç¼–è¯‘æ­¥éª¤

#### ä½¿ç”¨ Visual Studio

1. æ‰“å¼€è§£å†³æ–¹æ¡ˆ: `UNIX_File_Permission_Simulator.slnx`
2. é€‰æ‹©é…ç½®: Debug/Release, x64
3. ç”Ÿæˆ: `Ctrl+Shift+B` æˆ– **ç”Ÿæˆ > ç”Ÿæˆè§£å†³æ–¹æ¡ˆ**

#### ä½¿ç”¨ MSBuild å‘½ä»¤è¡Œ

```bash
# æ‰“å¼€ Visual Studio å¼€å‘è€…å‘½ä»¤æç¤ºç¬¦
cd D:\UNIX_File_Permission_Simulator

# ç¼–è¯‘æ•´ä¸ªè§£å†³æ–¹æ¡ˆ
msbuild UNIX_File_Permission_Simulator.slnx /p:Configuration=Debug /p:Platform=x64

# åªç¼–è¯‘å†…æ ¸é¡¹ç›®
msbuild KernProject/KernProject.vcxproj /p:Configuration=Debug /p:Platform=x64

# åªç¼–è¯‘æ¼”ç¤ºé¡¹ç›®
msbuild DemoProject/DemoProject.vcxproj /p:Configuration=Debug /p:Platform=x64
```

### ç¼–è¯‘è¾“å‡º

**KernProject (å†…æ ¸)**:
- è¾“å‡ºç›®å½•: `x64/Debug/` æˆ– `x64/Release/`
- è¾“å‡ºæ–‡ä»¶: `KernProject.lib`

**DemoProject (æ¼”ç¤º)**:
- è¾“å‡ºç›®å½•: `x64/Debug/` æˆ– `x64/Release/`
- è¾“å‡ºæ–‡ä»¶: `DemoProject.exe`

### è¿è¡Œç¨‹åº

```bash
# ç›´æ¥è¿è¡Œ
x64\Debug\DemoProject.exe

# æˆ–åœ¨ Visual Studio ä¸­
Ctrl+F5 (å¼€å§‹æ‰§è¡Œä¸è°ƒè¯•)
```

### ç¼–è¯‘é€‰é¡¹

**KernProject**:
- å¯ç”¨é¢„ç¼–è¯‘å¤´ (`/Yu`)
- ä½¿ç”¨ C è¿è¡Œæ—¶åº“
- è­¦å‘Šçº§åˆ«: W3

**DemoProject**:
- ä½¿ç”¨ C++ æ ‡å‡†åº“
- UTF-8 ç¼–ç  (`/utf-8`)
- æ§åˆ¶å°å­ç³»ç»Ÿ

---

## å¸¸è§ç¼–è¯‘é—®é¢˜

### é—®é¢˜1: æ— æ³•æ‰¾åˆ° KernProject.lib

**è§£å†³**:
1. ç¡®ä¿å…ˆç¼–è¯‘ KernProject
2. æ£€æŸ¥ DemoProject é¡¹ç›®å±æ€§ä¸­çš„é“¾æ¥å™¨è®¾ç½®
3. ç¡®ä¿åº“æ–‡ä»¶è·¯å¾„æ­£ç¡®

### é—®é¢˜2: ä¸­æ–‡ä¹±ç 

**è§£å†³**:
1. ç¡®ä¿å¯ç”¨ `/utf-8` ç¼–è¯‘é€‰é¡¹
2. åœ¨ç¨‹åºå¼€å¤´è°ƒç”¨ `SetConsoleOutputCP(65001)`
3. ç¡®ä¿æºæ–‡ä»¶ä¿å­˜ä¸º UTF-8 ç¼–ç 

### é—®é¢˜3: é“¾æ¥é”™è¯¯ LNK2019

**è§£å†³**:
1. æ£€æŸ¥å‡½æ•°å£°æ˜å’Œå®ç°æ˜¯å¦åŒ¹é…
2. ç¡®è®¤å‡½æ•°å·²å¯¼å‡º(ä½¿ç”¨ `__declspec(dllexport)` æˆ– `.def` æ–‡ä»¶)
3. æ£€æŸ¥è°ƒç”¨çº¦å®šæ˜¯å¦ä¸€è‡´

---

## ä»£ç é£æ ¼æŒ‡å—

### å‘½åè§„èŒƒ

- **å‡½æ•°**: å°å†™+ä¸‹åˆ’çº¿,å¦‚ `fs_create`, `um_find_user_by_uid`
- **å˜é‡**: å°å†™+ä¸‹åˆ’çº¿,å¦‚ `current_dir`, `file_count`
- **å¸¸é‡**: å…¨å¤§å†™+ä¸‹åˆ’çº¿,å¦‚ `MAX_FILES`, `PERM_READ`
- **ç±»å‹**: å¤§é©¼å³°,å¦‚ `FileNode`, `FileSystemStatus`

### æ³¨é‡Šè§„èŒƒ

```c
/**
 * å‡½æ•°åŠŸèƒ½ç®€è¿°
 * @param param1 å‚æ•°1è¯´æ˜
 * @param param2 å‚æ•°2è¯´æ˜
 * @return è¿”å›å€¼è¯´æ˜
 * @note ç‰¹æ®Šæ³¨æ„äº‹é¡¹
 */
ReturnType function_name(Type param1, Type param2) {
    // å®ç°
}
```

### ç¼©è¿›å’Œæ ¼å¼

- ä½¿ç”¨ 4 ç©ºæ ¼ç¼©è¿›
- å·¦å¤§æ‹¬å·å¦èµ·ä¸€è¡Œ(K&R é£æ ¼)
- æ¯è¡Œä¸è¶…è¿‡ 80 å­—ç¬¦

---

## ç‰ˆæœ¬å†å²

### v1.0 (2025)

- âœ… åŸºç¡€æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½
- âœ… ç”¨æˆ·å’Œç»„ç®¡ç†
- âœ… æƒé™æ§åˆ¶
- âœ… è·¯å¾„è§£æ(ç›¸å¯¹/ç»å¯¹)
- âœ… æ–‡ä»¶ç§»åŠ¨å’Œå¤åˆ¶
- âœ… é€’å½’åˆ é™¤
- âœ… äº¤äº’å¼ Shell
- âœ… ç»¼åˆæµ‹è¯•åœºæ™¯

---

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request!

### æäº¤ä»£ç å‰

1. âœ… è¿è¡Œæ‰€æœ‰æµ‹è¯•,ç¡®ä¿é€šè¿‡
2. âœ… æ·»åŠ ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹
3. âœ… æ›´æ–°ç›¸å…³æ–‡æ¡£
4. âœ… éµå¾ªä»£ç é£æ ¼æŒ‡å—
5. âœ… ç¡®ä¿æ— ç¼–è¯‘è­¦å‘Š

---

## è”ç³»æ–¹å¼

- **é¡¹ç›®**: UNIX æ–‡ä»¶æƒé™æ¨¡æ‹Ÿå™¨
- **ç‰ˆæœ¬**: 1.0
- **æ–‡æ¡£**: å¼€å‘è€…æ–‡æ¡£ v1.0

---

**ç¥å¼€å‘é¡ºåˆ©!** ğŸš€
